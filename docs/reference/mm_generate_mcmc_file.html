<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Generate the models in inst/models/bayes"><title>Generate the models in inst/models/bayes — mm_generate_mcmc_file • streamMetabolizer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate the models in inst/models/bayes — mm_generate_mcmc_file"><meta property="og:description" content="Generate the models in inst/models/bayes"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">streamMetabolizer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_prep.html">Data Preparation</a>
    <a class="dropdown-item" href="../articles/get_started.html">Quickstart</a>
    <a class="dropdown-item" href="../articles/gpp_er_eqs.html">GPP and ER Equations</a>
    <a class="dropdown-item" href="../articles/installation.html">Installation</a>
    <a class="dropdown-item" href="../articles/model_structures.html">Model Structures</a>
    <a class="dropdown-item" href="../articles/models_bayes.html">Bayesian Models</a>
    <a class="dropdown-item" href="../articles/models_mle.html">MLE Models</a>
    <a class="dropdown-item" href="../articles/ode_methods.html">ODE Methods</a>
    <a class="dropdown-item" href="../articles/simulations.html">Simulations</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USGS-R/streamMetabolizer/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Generate the models in inst/models/bayes</h1>
      <small class="dont-index">Source: <a href="https://github.com/USGS-R/streamMetabolizer/blob/HEAD/R/mm_generate_mcmc_file.R" class="external-link"><code>R/mm_generate_mcmc_file.R</code></a></small>
      <div class="d-none name"><code>mm_generate_mcmc_file.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generate the models in inst/models/bayes</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mm_generate_mcmc_file</span><span class="op">(</span></span>
<span>  type <span class="op">=</span> <span class="st">"bayes"</span>,</span>
<span>  pool_K600 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"normal"</span>, <span class="st">"normal_sdzero"</span>, <span class="st">"normal_sdfixed"</span>, <span class="st">"linear"</span>,</span>
<span>    <span class="st">"linear_sdzero"</span>, <span class="st">"linear_sdfixed"</span>, <span class="st">"binned"</span>, <span class="st">"binned_sdzero"</span>, <span class="st">"binned_sdfixed"</span><span class="op">)</span>,</span>
<span>  err_obs_iid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  err_proc_acor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  err_proc_iid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  err_proc_GPP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  ode_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trapezoid"</span>, <span class="st">"euler"</span><span class="op">)</span>,</span>
<span>  GPP_fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linlight"</span>, <span class="st">"satlight"</span><span class="op">)</span>,</span>
<span>  ER_fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"constant"</span><span class="op">)</span>,</span>
<span>  deficit_src <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DO_mod"</span>, <span class="st">"DO_obs"</span><span class="op">)</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"stan"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>type</dt>
<dd><p>character. The model type. Options:</p><ul><li><p><code>mle</code>:
maximum likelihood estimation (see also <code><a href="metab_mle.html">metab_mle</a></code>)</p></li>
<li><p><code>bayes</code>: bayesian hierarchical models <code><a href="metab_bayes.html">metab_bayes</a></code></p></li>
<li><p><code>night</code>: nighttime regression (see also <code><a href="metab_night.html">metab_night</a></code>)</p></li>
<li><p><code>Kmodel</code>: regression of <em>daily</em> estimates of
<code>K600.daily</code> versus discharge, time, etc., usually for 3-phase
estimation of K alone (by MLE or nighttime regression), K vs discharge
(using this model), and then GPP and ER with fixed K (by MLE) (see also
<code><a href="metab_Kmodel.html">metab_Kmodel</a></code>)</p></li>
<li><p><code>sim</code>: simulation of <code>DO.obs</code>
'data' for testing other models (see also <code><a href="metab_sim.html">metab_sim</a></code>)</p></li>
</ul></dd>


<dt>pool_K600</dt>
<dd><p>character. [How] should the model pool information among
days to get more consistent daily estimates for K600? Options (see Details
for more):</p><ul><li><p><code>none</code>: no pooling of K600</p></li>
<li><p><code>normal</code>: \(K600 ~ N(mu, sigma)\)</p></li>
<li><p><code>linear</code>: \(K600 ~
N(B[0] + B[1]*Q, sigma)\)</p></li>
<li><p><code>binned</code>: \(K600 ~ N(B[Q_bin],
sigma)\) where \(mu ~ N(mu_mu, mu_sigma)\) and \(sigma ~ N(sigma_mu,
sigma_sigma)\)</p></li>
<li><p><code>complete</code>: applicable only for
<code>type='Kmodel'</code>, which is generally used in conjunction with preceding
estimates of K (e.g., by <code>type='mle'</code> or <code>type='night'</code>) and
subsequent estimates of GPP and ER (e.g., by <code>type='mle'</code> with daily
K600 values specified)</p></li>
</ul></dd>


<dt>err_obs_iid</dt>
<dd><p>logical. Should IID observation error be included? If not,
the model will be fit to the differences in successive DO measurements,
rather than to the DO measurements themselves.</p></dd>


<dt>err_proc_acor</dt>
<dd><p>logical. Should autocorrelated process error (with the
autocorrelation term phi fitted) be included?</p></dd>


<dt>err_proc_iid</dt>
<dd><p>logical. Should IID process error be included?</p></dd>


<dt>err_proc_GPP</dt>
<dd><p>logical. Should IID process error in GPP be included?
This kind of error occurs only during the day and is used to adjust GPP
before passing that adjusted GPP into the dDO/dt equation. The GPP_inst
variable is the corrected GPP, and a new variable, GPP_inst_partial,
contains the pre-adjustment GPP estimates</p></dd>


<dt>ode_method</dt>
<dd><p>character. The method to use in solving the ordinary
differential equation for DO. Options:</p><ul><li><p><code>euler</code>,
formerly <code>Euler</code>: the final change in DO from t=1 to t=2 is solely a
function of GPP, ER, DO, etc. at t=1</p></li>
<li><p><code>trapezoid</code>, formerly
<code>pairmeans</code>: the final change in DO from t=1 to t=2 is a function of
the mean values of GPP, ER, etc. across t=1 and t=2.</p></li>
<li><p>for
<code>type='mle'</code>, options also include <code>rk2</code> and any character method
accepted by <code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode</a></code> in the <code>deSolve</code> package
(<code>lsoda</code>, <code>lsode</code>, <code>lsodes</code>, <code>lsodar</code>, <code>vode</code>,
<code>daspk</code>, <code>rk4</code>, <code>ode23</code>, <code>ode45</code>, <code>radau</code>,
<code>bdf</code>, <code>bdf_d</code>, <code>adams</code>, <code>impAdams</code>, and
<code>impAdams_d</code>; note that many of these have not been well tested in the
context of <code>streamMetabolizer</code> models)</p></li>
</ul></dd>


<dt>GPP_fun</dt>
<dd><p>character. Function dictating how gross primary productivity
(GPP) varies within each day. Options:</p><ul><li><p><code>linlight</code>: GPP
is a linear function of light with an intercept at 0 and a slope that
varies by day. <br><code>GPP(t) = GPP.daily * light(t) / mean.light</code></p><ul><li><p><code>GPP.daily</code>: the daily mean GPP, which is partitioned
into timestep-specific rates according to the fraction of that day's
average light that occurs at each timestep (specifically, <code>mean.light</code>
is the mean of the first 24 hours of the date's data window)</p></li>
</ul></li>
<li><p><code>satlight</code>: GPP is a saturating function of light. <br><code>GPP(t) =
Pmax * tanh(alpha * light(t) / Pmax)</code></p><ul><li><p><code>Pmax</code>: the
maximum possible GPP</p></li>
<li><p><code>alpha</code>: a descriptor of the rate of
increase of GPP as a function of light</p></li>
</ul></li>
<li><p><code>satlightq10temp</code>: GPP
is a saturating function of light and an exponential function of
temperature. <br><code>GPP(t) = Pmax * tanh(alpha * light(t) / Pmax) *
1.036 ^ (temp.water(t) - 20)</code></p><ul><li><p><code>Pmax</code>: the maximum
possible GPP</p></li>
<li><p><code>alpha</code>: a descriptor of the rate of increase of
GPP as a function of light</p></li>
</ul></li>
<li><p><code>NA</code>: applicable only to
<code>type='Kmodel'</code>, for which GPP is not estimated</p></li>
</ul></dd>


<dt>ER_fun</dt>
<dd><p>character. Function dictating how ecosystem respiration (ER)
varies within each day. Options:</p><ul><li><p><code>constant</code>: ER is
constant over every timestep of the day. <br><code>ER(t) = ER.daily</code></p><ul><li><p><code>ER.daily</code>: the daily mean ER, which is equal to
instantaneous ER at all times</p></li>
</ul></li>
<li><p><code>q10temp</code>: ER at each timestep
is an exponential function of the water temperature and a
temperature-normalized base rate. <br><code>ER(t) = ER20 * 1.045 ^
(temp.water(t) - 20)</code></p><ul><li><p><code>ER20</code>: the value of ER when
<code>temp.water</code> is 20 degrees C</p></li>
</ul></li>
<li><p><code>NA</code>: applicable only to
<code>type='Kmodel'</code>, for which ER is not estimated</p></li>
</ul></dd>


<dt>deficit_src</dt>
<dd><p>character. From what DO estimate (observed or modeled)
should the DO deficit be computed? Options:</p><ul><li><p><code>DO_mod</code>:
the DO deficit at time t will be (DO.sat(t) - DO_mod(t)), the difference
between the equilibrium-saturation value and the current best estimate of
the true DO concentration at that time</p></li>
<li><p><code>DO_obs</code>: the DO deficit
at time t will be (DO.sat(t) - DO.obs(t)), the difference between the
equilibrium-saturation value and the measured DO concentration at that time</p></li>
<li><p><code>DO_obs_filter</code>: applicable only to <code>type='night'</code>: a
smoothing filter is applied over the measured DO.obs values before applying
nighttime regression</p></li>
<li><p><code>NA</code>: applicable only to
<code>type='Kmodel'</code>, for which DO deficit is not estimated</p></li>
</ul></dd>


<dt>engine</dt>
<dd><p>character. With which function or software should the model
fitting be done?</p><ul><li><p>for <code>type='mle'</code>: <code>nlm</code> only
(the default)</p></li>
<li><p>for <code>type='bayes'</code>: <code>stan</code> only (the
default), an external software package that runs MCMC chains for Bayesian
models (see http://mc-stan.org)</p></li>
<li><p>for <code>type='night'</code>: <code>lm</code>
only (the default)</p></li>
<li><p>for <code>type='Kmodel'</code>: <code>mean</code>, <code>lm</code>,
or <code>loess</code> enable different types of relationships between daily K600
and its predictors (nothing, discharge, time, etc.)</p></li>
<li><p>for
<code>type='sim'</code>: <code>rnorm</code> only (the default)</p></li>
</ul></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Alison P. Appling, Robert O. Hall, Maite Arroita, Charles B. Yackulic.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

